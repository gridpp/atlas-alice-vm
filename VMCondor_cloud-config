output: {all: '| tee -a /var/log/cloud-init-output.log'}
bootcmd:
  - hostname ##user_data_machine_hostname##
  - echo `hostname --all-ip-addresses` `hostname` >>/etc/hosts
  - mkdir /scratch && chmod ugo+rwxt /scratch && mkfs -q -t ext4 /dev/vda2 && mount /dev/vda2 /scratch
  - fallocate -l 8G /mnt/.rw/swapfile
  - chmod 0600 /mnt/.rw/swapfile
  - mkswap /mnt/.rw/swapfile
  - swapon /mnt/.rw/swapfile
  - sysctl vm.swappiness=1
cvmfs:
    local:
        CVMFS_CACHE_BASE: /mnt/.rw/cvmfs-cache
        CVMFS_QUOTA_LIMIT: 7000
        CVMFS_REPOSITORIES: grid,alice,atlas,cms,lhcb
        CVMFS_HTTP_PROXY: ##user_data_option_cvmfs_proxy##
runcmd:
  - mkdir -p /scratch/condor/
  - chown condor:condor /scratch/condor/
write_files:
  - owner: root:root
    path: /etc/profile.d/mjf.sh
    permissions: '0644'
    content: |
        export MACHINEFEATURES=##user_data_machinefeatures_url##
        export JOBFEATURES=##user_data_jobfeatures_url##
        export JOBOUTPUTS=##user_data_joboutputs_url##
  - owner: root:root
    path: /etc/profile.d/mjf.csh
    permissions: '0644'
    content: |
        setenv MACHINEFEATURES ##user_data_machinefeatures_url##
        setenv JOBFEATURES ##user_data_jobfeatures_url##
        setenv JOBOUTPUTS ##user_data_joboutputs_url##
#
# Per-experiment write_files sections are appended here ...
#
